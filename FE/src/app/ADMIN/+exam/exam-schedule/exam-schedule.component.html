<div>
    <mat-card class="card-border p-0 mat-elevation-z8 m-3">
        <div>
            <mat-toolbar class="form-toolbar" color="primary">Assinged exams to class</mat-toolbar>
        </div>
        <div class="row m-0 pt-3">
            <div class="col-4"><b>Class</b></div>
            <div class="col-8">
                <div class="row">
                    <div class="col-6"><b>Exam</b></div>
                    <div class="col-6"><b>Action</b></div>
                </div>
            </div>
        </div>
        <div class="row m-0" *ngFor="let class of classList">
            <div class="col-4"> {{class.class_name}} </div>
            <div class="col-8">
                <div class="row">
                    <div class="col-6">
                        <div *ngFor="let exam of classWithExam">
                            <div *ngIf="class.class_id === exam.class_id">
                                <div class="row">
                                    <div class="col-1">
                                        <mat-icon matTooltip="Remove" matTooltipPosition="left" matTooltipClass="bg-warning" (click)="removeExam(class.class_id,exam.exam_id)">remove_circle</mat-icon>
                                    </div>
                                    <div class="col-9">{{exam.exam_name}}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-6">
                        <div *ngFor="let exam of classWithExam">
                            <div *ngIf="class.class_id === exam.class_id">
                                <mat-icon matTooltip="Schedule Exam" matTooltipPosition="right" matTooltipClass="bg-warning" (click)="checkTimeTable(class.class_id,exam.exam_id,class.class_name,exam.exam_name)">schedule</mat-icon>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </mat-card>
</div>

<div *ngIf="timeTable">
    <mat-card class="card-border-top p-0 mat-elevation-z8 m-3">
        <div>
            <mat-toolbar class="form-toolbar" color="primary">Time table of class {{className}} for {{examName}}</mat-toolbar>
        </div>
        <div class="text-center text-md-right">
            <button class="mt-3 mr-3" mat-raised-button color="primary"><mat-icon class="mr-1">update</mat-icon>Update</button>
            <button class="mt-3 mr-3" (click)="deleteExamSchedule(classId,examId)" mat-raised-button color="primary"><mat-icon class="mr-1">delete</mat-icon>Delete</button>
        </div>
        <div class="p-3 time-table">
            <table mat-table [dataSource]="examTimeTable" class="w-100 table-width mat-elevation-z8">

                <!-- subjectName Column -->
                <ng-container matColumnDef="subjectName">
                    <th mat-header-cell *matHeaderCellDef> Subject Name </th>
                    <td mat-cell *matCellDef="let element"> {{element.subject_name}} </td>
                </ng-container>

                <!-- examDate Column -->
                <ng-container matColumnDef="examDate">
                    <th mat-header-cell *matHeaderCellDef> Exam Date </th>
                    <td mat-cell *matCellDef="let element"> {{element.paper_date | date}} </td>
                </ng-container>

                <!-- startTime Column -->
                <ng-container matColumnDef="startTime">
                    <th mat-header-cell *matHeaderCellDef> Start Time </th>
                    <td mat-cell *matCellDef="let element"> {{element.paper_start_time}} </td>
                </ng-container>

                <!-- endTime Column -->
                <ng-container matColumnDef="endTime">
                    <th mat-header-cell *matHeaderCellDef> End Time </th>
                    <td mat-cell *matCellDef="let element"> {{element.paper_end_time}} </td>
                </ng-container>

                <!-- maxMarks Column -->
                <ng-container matColumnDef="maxMarks">
                    <th mat-header-cell *matHeaderCellDef> Max Marks </th>
                    <td mat-cell *matCellDef="let element"> {{element.total_marks}} </td>
                </ng-container>

                <!-- minMarks Column -->
                <ng-container matColumnDef="minMarks">
                    <th mat-header-cell *matHeaderCellDef> Min Marks </th>
                    <td mat-cell *matCellDef="let element"> {{element.passing_marks}} </td>
                </ng-container>

                <!-- roomNo Column -->
                <ng-container matColumnDef="roomNo">
                    <th mat-header-cell *matHeaderCellDef> Room No. </th>
                    <td mat-cell *matCellDef="let element"> {{element.room_number}} </td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="timeTableColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: timeTableColumns;"></tr>
            </table>
        </div>

    </mat-card>
</div>

<div *ngIf="examForm">
    <mat-card class="card-border-top p-0 mat-elevation-z8 m-3">
        <div>
            <mat-toolbar class="form-toolbar" color="primary">
                <mat-icon class="mr-2">schedule</mat-icon>
                Schedule Exam
            </mat-toolbar>
        </div>
        <form class="p-3" [formGroup]="scheduleExamForm" (ngSubmit)="scheduleExam()">
            <div>
                <div formArrayName="paperName">
                    <div *ngFor="let paper of scheduleExamForm.get('paperName').controls; let i = index">
                        <div class="row" [formGroupName]="i">
                            <div class="my-auto col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                {{subjectWithClass[i].subject_name}}
                            </div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <mat-form-field class="w-100" appearance="outline">
                                    <mat-label>Total Marks*</mat-label>
                                    <input formControlName="totalMarks" matInput placeholder="Total Marks*">
                                    <mat-error *ngIf="paper.invalid">
                                        <div> Total Marks is <strong>required*</strong></div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <mat-form-field class="w-100" appearance="outline">
                                    <mat-label>Passing Marks*</mat-label>
                                    <input formControlName="passingMarks" matInput placeholder="Passing Marks*">
                                    <mat-error *ngIf="paper.invalid">
                                        <div> Passing Marks is <strong>required*</strong></div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <mat-form-field class="w-100" appearance="outline">
                                    <mat-label>Paper Date*</mat-label>
                                    <input [matDatepickerFilter]="weekendBlock" formControlName="paperDate" matInput [matDatepicker]="paperDate" placeholder="Paper Date*" readonly>
                                    <mat-datepicker-toggle matSuffix [for]="paperDate"></mat-datepicker-toggle>
                                    <mat-datepicker #paperDate></mat-datepicker>
                                    <mat-error *ngIf="paper.invalid">
                                        <div> Paper Date is <strong>required*</strong></div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3"></div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <mat-form-field class="w-100" appearance="outline">
                                    <mat-label>Paper Start Time*</mat-label>
                                    <div class="time-picker d-flex">
                                        <input matInput formControlName="paperStartTime" [ngxTimepicker]="toggleStartTimepicker" placeholder="Paper Start Time*">
                                        <ngx-material-timepicker-toggle [for]="toggleStartTimepicker"></ngx-material-timepicker-toggle>
                                        <ngx-material-timepicker #toggleStartTimepicker></ngx-material-timepicker>
                                    </div>
                                    <mat-error *ngIf="paper.invalid">
                                        <div> Paper Start Time is <strong>required*</strong></div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <mat-form-field class="w-100" appearance="outline">
                                    <mat-label>Paper End Time*</mat-label>
                                    <div class="time-picker d-flex">
                                        <input matInput formControlName="paperEndTime" [ngxTimepicker]="toggleEndTimepicker" placeholder="Paper End Time*">
                                        <ngx-material-timepicker-toggle [for]="toggleEndTimepicker"></ngx-material-timepicker-toggle>
                                        <ngx-material-timepicker #toggleEndTimepicker></ngx-material-timepicker>
                                    </div>
                                    <mat-error *ngIf="paper.invalid">
                                        <div> Paper End Time is <strong>required*</strong></div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                            <div class="col-12 col-xs-12 col-sm-12 col-md-3 col-lg-3">
                                <mat-form-field class="w-100" appearance="outline">
                                    <mat-label>Room Number*</mat-label>
                                    <input formControlName="roomNumber" matInput placeholder="Room Number*">
                                    <mat-error *ngIf="paper.invalid">
                                        <div> Room Number is <strong>required*</strong></div>
                                    </mat-error>
                                </mat-form-field>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="text-right">
                <button [disabled]="scheduleExamForm.invalid" mat-raised-button color="primary"><mat-icon class="mr-1">schedule</mat-icon>Schedule</button>
            </div>
        </form>
    </mat-card>
</div>